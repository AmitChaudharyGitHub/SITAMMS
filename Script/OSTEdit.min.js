function Getgt(){null!=$("#AmountOfFreight").val()&&(f=$("#AmountOfFreight").val()),GT=+pf+ +Tax+ +Tdl+ +f,$("#GrandTotal").val(GT.toFixed(2))}function ValidMaster(){var e=$("#TransferDocumentNo").val(),t=$("#TransferDocumentDate").val(),a=$("#DispatchSite option:selected").val(),o=$("#ReceiveSite option:selected").val(),r=$("#pf").val(),n=$("#GrandTotal").val(),i=!0;return"0"==a?($("#DispatchSite").css("border-color","#f0551b"),i=!1):$("#DispatchSite").css("border-color",""),"0"==o?($("#ReceiveSite").css("border-color","#f0551b"),i=!1):$("#ReceiveSite").css("border-color",""),""==e?($("#TransferDocumentNo").css("border-color","#f0551b"),i=!1):$("#TransferDocumentNo").css("border-color",""),""==t?($("#TransferDocumentDate").css("border-color","#f0551b"),i=!1):$("#TransferDocumentDate").css("border-color",""),""==r?($("#pf").css("border-color","#f0551b"),i=!1):$("#pf").css("border-color",""),""==n?($("#GrandTotal").css("border-color","#f0551b"),i=!1):$("#GrandTotal").css("border-color",""),i}$(document).ready(function(){window.Trig1=!0;var e=null;window.getUniqueId=getUniqueId=function(){return e||(e=(new Date).getTime()),e++},window.GetPrj=function(e){return $("#dvLoading").show(),$.ajax({type:"POST",url:GetProjectByEmpId,dataType:"json",data:{E:ss},complete:function(){$("#dvLoading").hide()},success:function(e){var t="<option value='0'> Please wait...</option>";$("#DispatchSite").html(t).show(),$("#ReceiveSite").html(t).show();var a="<option value='0'>Select Dispatch Site</option>";$("#DispatchSite").html(a).show();var o="<option value='0'>Select Receive Site</option>";$("#ReceiveSite").html(o).show(),e=$.parseJSON(e);var r=$.parseJSON(e.List1),n=$.parseJSON(e.List2),i=$("#DispatchSite");$.each(r,function(e,t){i.append($("<option/>",{value:t.Value,text:t.Text}))});var d=$("#ReceiveSite");$.each(n,function(e,t){d.append($("<option/>",{value:t.Value,text:t.Text}))}),1==Trig1&&($("#DispatchSite").val(Master.DispatchSiteNo),$("#ReceiveSite").val(Master.ReceiveSiteNo),Trig1=!1)},error:function(e){alert("Failed to retrieve Projects."+e)}}),!1},GetPrj(),window.GetMasters=function(){$("#TransferDocumentNo").val(Master.TransferDocumentNo),$("#ChallanNo").val(Master.ChallanNo),$("#VehicleNo").val(Master.VehicleNo),$("#pf").val(Master.P_F),$("#Vat").val(Master.Vat),$("#TDeliveryCharges").val(Master.DeliveryCharges),$("#AmountOfFreight").val(Master.AmountOfFreight),$("#GrandTotal").val(Master.GrandTotal)},GetMasters(),window.GetChild=function(){for(var e=Child,t=0;t<e.length;t++){var a=e[t],o=new Object;o.Id=getUniqueId(),o.UId=a.TbOSTTransferChild.UId,o.MUId=a.TbOSTTransferChild.MUId,o.ItemGroup=a.ItemGroupName,o.ItemGroupNo=a.TbOSTTransferChild.ItemGroupNo,o.Itemname=a.ItemName,o.ItemNo=a.TbOSTTransferChild.ItemNo,o.Unit=a.UnitName,o.UnitNo=a.TbOSTTransferChild.UnitNo,o.Qty=a.TbOSTTransferChild.Qty,o.Rate=a.TbOSTTransferChild.Rate,o.DeliveryCharges=a.TbOSTTransferChild.DeliveryCharges,o.TaxType=a.TbOSTTransferChild.TaxType,o.Vat=a.TbOSTTransferChild.Vat,o.Amount=a.TbOSTTransferChild.Amount,gridList.push(o),$("#grid").prepend("<tr class='danger _tempRow'><td>"+o.ItemGroup+"</td><td>"+o.Itemname+"</td><td>"+o.Unit+"</td><td>"+o.Qty+"</td><td>"+o.Rate+"</td><td>"+o.DeliveryCharges+"</td><td>"+o.TaxType+"</td><td>"+o.Vat+"</td><td>"+o.Amount+"</td><td><a href='#' id='removeItem' uniqueId='"+o.Id+"'>Remove</a></td></tr>")}},GetChild()}),$(document).ready(function(){$("#DispatchSite").change(function(){return $("#TransferDocumentNo").empty(),0!=$("#DispatchSite option:selected").val()?($("#dvLoading").show(),$.ajax({type:"POST",url:GetOstNo,dataType:"json",data:{ProjectID:$("#DispatchSite").val()},complete:function(){$("#dvLoading").hide()},success:function(e){e=$.parseJSON(e),$("#TransferDocumentNo").val(e)},error:function(e){alert("Failed to retrieve Transfer Document No."+e)}}),!1):void 0})}),$(document).ready(function(){$("#ItemGroup").change(function(){return $("#ItemMaster").empty(),$("#ItemMaster").append($("<option></option").val("").html("Select Item Name")),0!=$("#ItemGroup option:selected").val()?($("#dvLoading").show(),$.ajax({type:"POST",url:GetItemByGroup,dataType:"json",data:{id:$("#ItemGroup").val()},complete:function(){$("#dvLoading").hide()},success:function(e){e=$.parseJSON(e),$.each(e,function(e,t){$("#ItemMaster").append('<option value="'+t.Value+'">'+t.Text+"</option>")})},error:function(e){alert("Failed to retrieve Item Name."+e)}}),!1):void 0})}),$(document).ready(function(){$("#ItemMaster").change(function(){return $("#Unit").empty(),0!=$("#ItemMaster option:selected").val()?($("#dvLoading").show(),$.ajax({type:"POST",url:GetItemDetail,dataType:"json",data:{id:$("#ItemMaster").val(),PrjId:$("#DispatchSite").val()},complete:function(){$("#dvLoading").hide()},success:function(e){e=$.parseJSON(e),$("#Rate").val(e.Rate),$("#Unit").val(e.Unit),$("#Unit").attr("UNo",e.UnitNo)},error:function(e){alert("Failed to retrieve Unit"+e)}}),!1):void 0})}),$(document).ready(function(){$("#TaxType").change(function(){var e=$("#TaxType option:selected").val();$("#TaxPer").val(e)})}),$(document).ready(function(){function e(){if(null!=$("#Rate").val()&&null!=$("#Qty").val()){var e=$("#Rate").val()*$("#Qty").val();$("#Amount").val(e.toFixed(2))}else $("#Amount").val(0)}$("#Rate").keyup(function(){e()}),$("#Qty").keyup(function(){e()})}),$(document).ready(function(){$("#AmountOfFreight").keyup(function(){Getgt()})});var gridList=[],pf=0,Tdl=0,Tax=0,GT=0,f=0,child=0,nowTemp=new Date,now=new Date(nowTemp.getFullYear(),nowTemp.getMonth(),nowTemp.getDate(),0,0,0,0);$(document).ready(function(){function e(){var e=new Object;return e.TransferDocumentNo=$("#TransferDocumentNo").val(),e.TransferDocumentDate=$("#TransferDocumentDate").val(),e.DispatchSiteNo=$("#DispatchSite option:selected").val(),e.ReceiveSiteNo=$("#ReceiveSite option:selected").val(),e.ChallanNo=$("#ChallanNo").val(),e.ChallanDate=$("#ChallanDate").val(),e.VehicleNo=$("#VehicleNo").val(),e.P_F=$("#pf").val(),e.Vat=$("#Vat").val(),e.DeliveryCharges=$("#TDeliveryCharges").val(),e.AmountOfFreight=$("#AmountOfFreight").val(),e.GrandTotal=$("#GrandTotal").val(),e.UId=Master.UId,e.SessionId=Master.SessionId,e.CreatedBy=Master.CreatedBy,e.OSTId=Master.OSTId,e}function t(){pf=0,Tdl=0,Tax=0,GT=0,null!=$("#AmountOfFreight").val()&&(f=$("#AmountOfFreight").val());for(var e=0;e<gridList.length;e++)pf=+pf+ +gridList[e].Amount,$("#pf").val(pf.toFixed(2)),Tdl=+Tdl+ +(gridList[e].Qty*gridList[e].DeliveryCharges),$("#TDeliveryCharges").val(Tdl.toFixed(2)),Tax=+Tax+ +(gridList[e].Amount*gridList[e].Vat/100),$("#Vat").val(Tax.toFixed(2));GT=+pf+ +Tax+ +Tdl+ +f,$("#GrandTotal").val(GT.toFixed(2))}$("#addNew").click(function(){var e=new Object;return e.Id=getUniqueId(),e.ItemGroup=$("#ItemGroup option:selected").text(),e.ItemGroupNo=$("#ItemGroup option:selected").val(),e.Itemname=$("#ItemMaster option:selected").text(),e.ItemNo=$("#ItemMaster option:selected").val(),e.Unit=$("#Unit").val(),e.UnitNo=$("#Unit").attr("UNo"),e.Qty=$("#Qty").val(),e.Rate=$("#Rate").val(),e.DeliveryCharges=$("#DeliveryCharges").val(),0!=$("#TaxType option:selected").val()?e.TaxType=$("#TaxType option:selected").text():e.TaxType="",e.Vat=$("#TaxPer").val(),e.Amount=$("#Amount").val(),""==e.Qty?void $("#Qty").css("border-color","#f0551b"):(""==e.Rate&&$("#Rate").css("border-color","#f0551b"),gridList.push(e),$("#grid").prepend("<tr class='danger _tempRow'><td>"+e.ItemGroup+"</td><td>"+e.Itemname+"</td><td>"+e.Unit+"</td><td>"+e.Qty+"</td><td>"+e.Rate+"</td><td>"+e.DeliveryCharges+"</td><td>"+e.TaxType+"</td><td>"+e.Vat+"</td><td>"+e.Amount+"</td><td><a href='#' id='removeItem' uniqueId='"+e.Id+"'>Remove</a></td></tr>"),t(),child=1,$("#Qty").val(""),$("#Rate").val(""),$("#Amount").val(""),$("#DeliveryCharges").val(""),$("#Qty").css("border-color",""),void $("#Rate").css("border-color",""))}),$("#Submit").click(function(){if(gridList.length<1)return void alert("Add Any Item");var t=ValidMaster();if(0!=t){var a=e(),o={Child:gridList,Master:a},r=SendList2;$("#dvLoading").show(),$.ajax({type:"Post",url:r,data:JSON.stringify(o),contentType:"application/json; charset=utf-8",dataType:"json",processdata:!0,complete:function(){$("#dvLoading").hide()},success:function(e){"1"==e&&($("#myModal").modal("show"),Trig1=!0,$("#TransferDocumentNo").val(""),$("#TransferDocumentDate").datepicker("setDate",""),$("#DispatchSite").prop("selectedIndex",0),$("#ReceiveSite").prop("selectedIndex",0),$("#ChallanNo").val(""),$("#ChallanDate").datepicker("setDate",""),$("#VehicleNo").val(""),$("#pf").val(""),$("#Vat").val(""),$("#TDeliveryCharges").val(""),$("#AmountOfFreight").val(""),$("#GrandTotal").val(""),gridList=[],$("#grid").empty())},error:function(){alert("Error in Submit Data")}})}}),$("body").on("click","#removeItem",function(){for(var e=$(this).attr("uniqueId"),a=0;a<gridList.length;a++)gridList[a].Id==e&&(gridList.splice(a,1),$(this).parents("._tempRow").remove());t()})}),$(document).ready(function(){$(".DatePicker").datepicker({dateFormat:"dd M yy",changeMonth:!0,changeYear:!0,value:""})});